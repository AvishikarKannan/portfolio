<!DOCTYPE html>
<html class="dark" lang="en">

<head>
  <meta charset="utf-8" />
  <link crossorigin="" href="https://fonts.gstatic.com/" rel="preconnect" />
  <link as="style"
    href="https://fonts.googleapis.com/css2?display=swap&amp;family=Noto+Sans%3Awght%40400%3B500%3B700%3B900&amp;family=Space+Grotesk%3Awght%40400%3B500%3B700"
    onload="this.rel='stylesheet'" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />
  <title>Candidates</title>
  <link href="data:image/x-icon;base64," rel="icon" type="image/x-icon" />
  <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
  <script>
    tailwind.config = {
      darkMode: "class",
      theme: {
        extend: {
          colors: {
            "primary": "#38e07b",
            "background-light": "#f6f8f7",
            "background-dark": "#122017",
          },
          fontFamily: {
            "display": ["Space Grotesk"]
          },
          borderRadius: {
            "DEFAULT": "0.25rem",
            "lg": "0.5rem",
            "xl": "0.75rem",
            "full": "9999px"
          },
        },
      },
    }
  </script>
  <!-- Supabase for dynamic data -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script>
    // Configuration
    const SUPABASE_URL = 'https://pyfvjoldnpygwxerpxat.supabase.co';
    const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InB5ZnZqb2xkbnB5Z3d4ZXJweGF0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTgyODE5OTksImV4cCI6MjA3Mzg1Nzk5OX0.2vw4rPRWF4YRPq-x_G_PaO0KNEDlC876it92YIOYZJs';
    
    let supabaseClient;
    let staticCandidates = []; // Store static candidates as fallback

    // Initialize
    document.addEventListener('DOMContentLoaded', async function() {
      // Store static candidates as fallback
      staticCandidates = Array.from(document.querySelectorAll('tbody tr')).map(row => {
        const cells = row.querySelectorAll('td');
        return {
          name: cells[0]?.textContent || '',
          age: cells[1]?.textContent || '',
          gender: cells[2]?.textContent || '',
          location: cells[3]?.textContent || '',
          keyStrength: cells[4]?.textContent || '',
          status: cells[5]?.textContent || '',
          videoUrl: cells[6]?.querySelector('a')?.href || '#'
        };
      });

      // Try to load from Supabase
      try {
        supabaseClient = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);
        await loadCandidatesFromSupabase();
      } catch (error) {
        console.log('Using static data (Supabase not available):', error);
      }

      // Setup search
      setupSearch();
    });

    async function loadCandidatesFromSupabase() {
      try {
        const { data, error } = await supabaseClient
          .from('candidates')
          .select('*')
          .order('created_at', { ascending: false });

        if (error) throw error;

        if (data && data.length > 0) {
          renderCandidates(data);
        }
      } catch (error) {
        console.log('Failed to load from Supabase, using static data');
      }
    }

    function getVideoUrl(videoUrl) {
      if (!videoUrl) return '#';
      
      // Direct URL (Supabase public URL or any other direct link)
      if (videoUrl.startsWith('http')) {
        return videoUrl;
      }
      
      return '#';
    }

    function renderCandidates(candidates) {
      const tbody = document.querySelector('tbody');
      if (!tbody) return;

      tbody.innerHTML = candidates.map(candidate => `
        <tr class="hover:bg-primary/10 dark:hover:bg-primary/20">
          <td class="whitespace-nowrap px-6 py-4 text-sm font-medium text-black dark:text-white">${candidate.name}</td>
          <td class="whitespace-nowrap px-6 py-4 text-sm text-black/60 dark:text-white/60">${candidate.age}</td>
          <td class="whitespace-nowrap px-6 py-4 text-sm text-black/60 dark:text-white/60">${candidate.gender}</td>
          <td class="whitespace-nowrap px-6 py-4 text-sm text-black/60 dark:text-white/60">${candidate.location}</td>
          <td class="whitespace-nowrap px-6 py-4 text-sm">
            <span class="rounded-full bg-primary/20 px-3 py-1 text-xs font-medium text-primary">${candidate.key_strength}</span>
          </td>
          <td class="whitespace-nowrap px-6 py-4 text-sm">
            ${getStatusBadge(candidate.status)}
          </td>
          <td class="whitespace-nowrap px-6 py-4 text-sm">
            ${getVideoLink(candidate.video_url)}
          </td>
        </tr>
      `).join('');
    }

    function getStatusBadge(status) {
      if (status === 'Top Performer') {
        return `<span class="flex items-center gap-2 rounded-full bg-primary px-3 py-1 text-xs font-medium text-background-dark">
          <span class="material-symbols-outlined text-sm">star</span>Top Performer
        </span>`;
      }
      return `<span class="rounded-full bg-primary/20 px-3 py-1 text-xs font-medium text-primary">${status}</span>`;
    }

    function getVideoLink(videoUrl) {
      const url = getVideoUrl(videoUrl);
      if (url === '#') {
        return '<span class="text-black/40 dark:text-white/40">No video</span>';
      }
      return `<a href="${url}" target="_blank" class="text-primary hover:underline">View</a>`;
    }

    function setupSearch() {
      const searchInput = document.querySelector('input[placeholder*="Search candidates"]');
      if (searchInput) {
        searchInput.addEventListener('input', function(e) {
          const searchTerm = e.target.value.toLowerCase();
          const rows = document.querySelectorAll('tbody tr');
          
          rows.forEach(row => {
            const text = row.textContent.toLowerCase();
            if (text.includes(searchTerm)) {
              row.style.display = '';
            } else {
              row.style.display = 'none';
            }
          });
        });
      }
    }
  </script>
</head>

<body class="bg-background-light dark:bg-background-dark font-display">
  <div class="flex min-h-screen flex-col">
    <header
      class="sticky top-0 z-10 flex h-16 items-center justify-between border-b border-white/10 bg-background-light/80 px-4 backdrop-blur-sm dark:bg-background-dark/80 sm:px-6 lg:px-8">
      <div class="flex items-center gap-4">
        <div class="flex items-center gap-2 text-black dark:text-white">
          <span class="material-symbols-outlined text-primary text-3xl">
            sports_soccer
          </span>
          <h2 class="text-lg font-bold">AthletiQ</h2>
        </div>
      </div>
      <nav class="hidden items-center gap-6 md:flex">
        <a class="text-sm font-medium text-black/60 transition-colors hover:text-black dark:text-white/60 dark:hover:text-white"
          href="./dash.html">Dashboard</a>
        <a class="text-sm font-medium text-black dark:text-white" href="./cand.html">Candidates</a>
        <a class="text-sm font-medium text-black/60 transition-colors hover:text-black dark:text-white/60 dark:hover:text-white"
          href="./sus.html">Assessments</a>
        <a class="text-sm font-medium text-black/60 transition-colors hover:text-black dark:text-white/60 dark:hover:text-white"
          href="./repots.html">Reports</a>
        <a class="text-sm font-medium text-black/60 transition-colors hover:text-black dark:text-white/60 dark:hover:text-white"
          href="./settings.html">Settings</a>
      </nav>
      <div class="flex items-center gap-4">
        <button
          class="flex h-10 w-10 items-center justify-center rounded-full bg-transparent text-black ring-1 ring-inset ring-white/10 transition-colors hover:bg-primary/20 dark:text-white">
          <span class="material-symbols-outlined">
            notifications
          </span>
        </button>
        <div class="size-10 rounded-full bg-cover bg-center"
          style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuDq8K_Wg7WlIaux8G0u_5Uxgk3XTCFxPGqc-iZ7-crPU7SwrwgTaYltKmZlnmNKzPq890EH30RmEdd1ok1RLlfKE7TYOTVcQ6r97MFNy0YTZihUKYJOdJTQv193lLgJ0U4QK8kbxseFPO4OqsgewAzy5I0WH2TM5TvYPDjAn6u4GLBz6YTPWCe5vIddXLFUiwZz9jwX6c3x9WEdVNQNBWtZBy1fKFiOOKIySQKI-8I4iDjx7eF_IB067ME6AD53SdWjTm_1iI5pTTE");'>
        </div>
      </div>
    </header>
    <main class="flex-1 p-4 sm:p-6 lg:p-8">
      <div class="mx-auto max-w-7xl">
        <div class="mb-8">
          <h1 class="text-3xl font-bold text-black dark:text-white">Candidates</h1>
          <p class="text-black/60 dark:text-white/60">Manage and evaluate potential sports talents.</p>
        </div>
        <div class="mb-6 flex flex-wrap items-center justify-between gap-4">
          <div class="relative w-full max-w-sm">
            <span
              class="material-symbols-outlined pointer-events-none absolute left-3 top-1/2 -translate-y-1/2 text-black/50 dark:text-white/50">
              search
            </span>
            <input
              class="w-full rounded-lg border-white/10 bg-white/5 py-2 pl-10 pr-4 text-black ring-1 ring-inset ring-white/10 focus:ring-2 focus:ring-inset focus:ring-primary dark:bg-white/5 dark:text-white"
              placeholder="Search candidates by name or ID" />
          </div>
          <div class="flex flex-wrap gap-2">
            <button
              class="flex items-center justify-center gap-x-2 rounded-lg bg-white/5 px-4 py-2 text-sm font-medium text-black ring-1 ring-inset ring-white/10 hover:bg-primary/10 dark:bg-white/5 dark:text-white dark:hover:bg-primary/20">
              <span>Age Group</span>
              <span class="material-symbols-outlined text-base">
                expand_more
              </span>
            </button>
            <button
              class="flex items-center justify-center gap-x-2 rounded-lg bg-white/5 px-4 py-2 text-sm font-medium text-black ring-1 ring-inset ring-white/10 hover:bg-primary/10 dark:bg-white/5 dark:text-white dark:hover:bg-primary/20">
              <span>Gender</span>
              <span class="material-symbols-outlined text-base">
                expand_more
              </span>
            </button>
            <button
              class="flex items-center justify-center gap-x-2 rounded-lg bg-white/5 px-4 py-2 text-sm font-medium text-black ring-1 ring-inset ring-white/10 hover:bg-primary/10 dark:bg-white/5 dark:text-white dark:hover:bg-primary/20">
              <span>Region</span>
              <span class="material-symbols-outlined text-base">
                expand_more
              </span>
            </button>
          </div>
        </div>
        <div class="overflow-hidden rounded-xl border border-white/10 bg-white/5 shadow-sm dark:bg-white/5">
          <div class="overflow-x-auto">
            <table class="w-full table-auto">
              <thead class="bg-white/5 dark:bg-black/10">
                <tr>
                  <th
                    class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-black/60 dark:text-white/60">
                    Name</th>
                  <th
                    class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-black/60 dark:text-white/60">
                    Age</th>
                  <th
                    class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-black/60 dark:text-white/60">
                    Gender</th>
                  <th
                    class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-black/60 dark:text-white/60">
                    Location</th>
                  <th
                    class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-black/60 dark:text-white/60">
                    Key Strength</th>
                  <th
                    class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-black/60 dark:text-white/60">
                    Status</th>
                  <th
                    class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-black/60 dark:text-white/60">
                    Video</th>
                </tr>
              </thead>
              <tbody class="divide-y divide-white/10">
                <tr class="hover:bg-primary/10 dark:hover:bg-primary/20">
                  <td class="whitespace-nowrap px-6 py-4 text-sm font-medium text-black dark:text-white">Aarav Patel</td>
                  <td class="whitespace-nowrap px-6 py-4 text-sm text-black/60 dark:text-white/60">22</td>
                  <td class="whitespace-nowrap px-6 py-4 text-sm text-black/60 dark:text-white/60">Male</td>
                  <td class="whitespace-nowrap px-6 py-4 text-sm text-black/60 dark:text-white/60">Mumbai, MH</td>
                  <td class="whitespace-nowrap px-6 py-4 text-sm"><span class="rounded-full bg-primary/20 px-3 py-1 text-xs font-medium text-primary">Speed</span></td>
                  <td class="whitespace-nowrap px-6 py-4 text-sm"><span class="rounded-full bg-primary/20 px-3 py-1 text-xs font-medium text-primary">Active</span></td>
                  <td class="whitespace-nowrap px-6 py-4 text-sm"><a href="https://pyfvjoldnpygwxerpxat.supabase.co/storage/v1/object/public/candidate-videos/aarav.mp4" target="_blank" class="text-primary hover:underline">View</a></td>
                </tr>

                <tr class="hover:bg-primary/10 dark:hover:bg-primary/20">
                  <td class="whitespace-nowrap px-6 py-4 text-sm font-medium text-black dark:text-white">Ananya Singh</td>
                  <td class="whitespace-nowrap px-6 py-4 text-sm text-black/60 dark:text-white/60">20</td>
                  <td class="whitespace-nowrap px-6 py-4 text-sm text-black/60 dark:text-white/60">Female</td>
                  <td class="whitespace-nowrap px-6 py-4 text-sm text-black/60 dark:text-white/60">Chennai, TN</td>
                  <td class="whitespace-nowrap px-6 py-4 text-sm"><span class="rounded-full bg-primary/20 px-3 py-1 text-xs font-medium text-primary">Strength</span></td>
                  <td class="whitespace-nowrap px-6 py-4 text-sm"><span class="rounded-full bg-primary/20 px-3 py-1 text-xs font-medium text-primary">Active</span></td>
                  <td class="whitespace-nowrap px-6 py-4 text-sm"><a href="https://pyfvjoldnpygwxerpxat.supabase.co/storage/v1/object/public/candidate-videos/ananya.mp4" target="_blank" class="text-primary hover:underline">View</a></td>
                </tr>

                <tr class="hover:bg-primary/10 dark:hover:bg-primary/20">
                  <td class="whitespace-nowrap px-6 py-4 text-sm font-medium text-black dark:text-white">Diya Sharma</td>
                  <td class="whitespace-nowrap px-6 py-4 text-sm text-black/60 dark:text-white/60">21</td>
                  <td class="whitespace-nowrap px-6 py-4 text-sm text-black/60 dark:text-white/60">Female</td>
                  <td class="whitespace-nowrap px-6 py-4 text-sm text-black/60 dark:text-white/60">Delhi, DL</td>
                  <td class="whitespace-nowrap px-6 py-4 text-sm"><span class="rounded-full bg-primary/20 px-3 py-1 text-xs font-medium text-primary">Agility</span></td>
                  <td class="whitespace-nowrap px-6 py-4 text-sm"><span class="flex items-center gap-2 rounded-full bg-primary px-3 py-1 text-xs font-medium text-background-dark"><span class="material-symbols-outlined text-sm">star</span>Top Performer</span></td>
                  <td class="whitespace-nowrap px-6 py-4 text-sm"><a href="https://pyfvjoldnpygwxerpxat.supabase.co/storage/v1/object/public/candidate-videos/diya.mp4" target="_blank" class="text-primary hover:underline">View</a></td>
                </tr>

                <tr class="hover:bg-primary/10 dark:hover:bg-primary/20">
                  <td class="whitespace-nowrap px-6 py-4 text-sm font-medium text-black dark:text-white">Rohan Gupta</td>
                  <td class="whitespace-nowrap px-6 py-4 text-sm text-black/60 dark:text-white/60">23</td>
                  <td class="whitespace-nowrap px-6 py-4 text-sm text-black/60 dark:text-white/60">Male</td>
                  <td class="whitespace-nowrap px-6 py-4 text-sm text-black/60 dark:text-white/60">Bangalore, KA</td>
                  <td class="whitespace-nowrap px-6 py-4 text-sm"><span class="rounded-full bg-primary/20 px-3 py-1 text-xs font-medium text-primary">Endurance</span></td>
                  <td class="whitespace-nowrap px-6 py-4 text-sm"><span class="rounded-full bg-primary/20 px-3 py-1 text-xs font-medium text-primary">Active</span></td>
                  <td class="whitespace-nowrap px-6 py-4 text-sm"><a href="https://pyfvjoldnpygwxerpxat.supabase.co/storage/v1/object/public/candidate-videos/rohan.mp4" target="_blank" class="text-primary hover:underline">View</a></td>
                </tr>


              </tbody>
            </table>

          </div>
        </div>
      </div>
    </main>
  </div>

</body>

</html>
